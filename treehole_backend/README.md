# 接口文档

## 

## 返回结果结构及状态码

### 1、返回结构

{

​		code:   状态码,

​		msg:    描述,

​		data:   数据,

​		total：数据总条数,

}



### 2、状态码

| code | msg                  |
| ---- | -------------------- |
| 1000 | 成功（可变）         |
| 1001 | 失败（可变）         |
| 1002 | 请求参数错误（可变） |
| 1003 | 邮箱已被注册         |
| 1004 | 用户已存在           |
| 1005 | 用户名或密码错误     |
| 1006 | 该邮箱不存在         |
| 1007 | 无效token            |
| 1008 | Token已过期          |



## 登录业务接口

### 1、发送邮箱验证码

```
[POST] http://localhost:8080/api/v1/sendEmailCode
```

**发送参数**

数据格式：json数据

| email | string | 用户邮箱 |
| ----- | ------ | -------- |

**返回结果**

| code | msg                          |
| ---- | ---------------------------- |
| 1000 | 发送邮箱验证码成功           |
| 1001 | 发送邮箱验证码失败           |
| 1002 | 请求参数错误、邮箱格式不正确 |

> 验证码有效期为5分钟



### 2、用户注册

```
[POST] http://localhost:8080/api/v1/register
```

**发送参数**

```
{
    "username": "",
    "email": "",
    "code": "",
    "repassword": "",
    "password": ""
}
```

**返回结果**

| code | msg                                                        |
| ---- | ---------------------------------------------------------- |
| 1000 | 注册成功                                                   |
| 1001 | 验证码已过期，请重新获取、验证码错误，请重新输入、注册失败 |
| 1002 | 请求参数错误、邮箱格式不正确                               |
| 1003 | 该邮箱已被注册                                             |
| 1004 | 该用户已存在                                               |

```json
{
  "code": 1000,
  "msg": "注册成功",
  "data": {
    "token": ”“，
  },
  "total": 0
}
```

> token放到头部的"Authorization"字段，有效期为5天



### 3、获取图片验证码

```
[GET] http://localhost:8080/api/v1/capacha/get
```

**返回结果**

| code | msg                |
| ---- | ------------------ |
| 1000 | 获取图片验证码成功 |
| 1001 | 获取图片验证码失败 |

```
{
    "code": 1000,
    "msg": "获取图片验证码成功",
    "data": {
        "base64": ”“,
        "captchaId": ""   // 图片id，验证时需要和用户输入的验证码一起传入
    },
    "total": 0
}
```



### 4、验证图片验证码

```
[GET] http://localhost:8080/api/v1/capacha/verify?capachaId=......&capachaVal= ......
```

**返回结果**

| code | msg                |
| ---- | ------------------ |
| 1000 | 验证图片验证码成功 |
| 1001 | 验证图片验证码失败 |

```
{
  "code": 1000,
  "msg": "验证图片验证码成功",
  "data": "",
  "total": 0
}
```



### 5、用户登录

```
[POST] http://localhost:8080/api/v1/login
```

**发送参数**

```
{
    "username": "",
    "repassword": "",
    "password": ""
}
```

**返回结果**

| code | msg              |
| ---- | ---------------- |
| 1000 | 登录成功         |
| 1001 | 登录失败         |
| 1002 | 请求参数错误     |
| 1005 | 用户名或密码错误 |

```json
{
  "code": 1000,
  "msg": "注册成功",
  "data": {
    "token": ”“，
  },
  "total": 0
}
```

> token放到头部的"Authorization"字段，有效期为5天



### 6、找回密码

流程：填写邮箱获取邮箱验证码->验证邮箱验证码和邮箱信息（返回token）->进入修改信息页面（用户名，密码，确认密码）



#### 1）获取邮箱验证码

使用下述接口：

```
[POST] http://localhost:8080/api/v1/sendEmailCode
```



#### 2）验证邮箱验证码和邮箱信息

```
[POST] http://localhost:8080/api/v1/forgetPassword/verifyEmailCode
```

**发送参数**

```
{
    "email": "",
    "code": ""
}
```

**返回结果**

| code | msg                                                          |
| ---- | ------------------------------------------------------------ |
| 1000 | 验证成功                                                     |
| 1001 | 验证失败、验证码已过期，请重新获取、验证码不正确，请重新输入 |
| 1002 | 请求参数错误                                                 |
| 1006 | 该邮箱不存在                                                 |

```json
{
  "code": 1000,
  "msg": "注册成功",
  "data": {
    "token": ”“，
  },
  "total": 0
}
```

> token放到头部的"Authorization"字段，有效期为5天



#### 3）修改用户信息

流程：中间件验证token信息 -> 进行用户密码修改。

```
[POST] http://localhost:8080/api/v1/forgetPassword/verifyEmailCode
```

**发送参数**

```
{
    "username": "",
    "repassword": "",
    "password": ""
}
```

**返回结果**

| code | msg          |
| ---- | ------------ |
| 1000 | 修改成功     |
| 1001 | 修改失败     |
| 1002 | 请求参数错误 |
| 1007 | 无效token    |
| 1008 | Token已过期  |

```json
{
  "code": 1000,
  "msg": "修改成功",
  "data": {
    "token": "",
  },
  "total": 0
}
```

> token放到头部的"Authorization"字段，有效期为5天